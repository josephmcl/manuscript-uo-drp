\begin{figure}
\begin{tikzpicture}
    \begin{axis}[
	    legend style={
            at={(0.5,-0.2)},
            anchor=north,
            legend columns=2},
        height=2.5in,
        width=3.375in,
        axis x line*=bottom,
        axis y line*=left,
        symbolic x coords = {9, 16, 25, 36, 49, 64, 100, 144, 196, 225, 400, 441, 576, 784, 900, 1225, 1600},
        xtick = {9, 49, 196, 576, 1600},
        ytick distance=2000000,
        domain = 9:1600,
        range = 0:10000000,
        xlabel={Elements},
        ylabel={FLOP/s}]
	\addplot[
        mark=+,
        color=red] coordinates {
            (9,24160.18916)
			(16,46212.11403)
			(25,75762.76323)
			(36,115210.3523)
			(49,156578.57)
			(64,203576.4992)
			(100,314453.8084)
			(144,441429.8691)
			(196,578962.5209)
			(225,644095.8587)
			(400,846784.4182)
			(441,837067.0372)
			(576,694117.3025)
			(784,414388.6676)
			(900,303442.8543)
			(1225,135813.9212)
			(1600,63858.08331)};
	\addlegendentry{1 Thread}
    \addplot[
        mark=o,
        color=blue] coordinates {
            (9,78513.66238)
			(16,133745.4278)
			(25,217815.5867)
			(36,340888.9967)
			(49,548515.3324)
			(64,717364.6669)
			(100,1091864.432)
			(144,1489948.304)
			(196,1859190.77)
			(225,2052879.643)
			(400,2484952.613)
			(441,2489810.713)
			(576,2067020.621)
			(784,1398554.858)
			(900,1030993.746)
			(1225,487411.0526)
			(1600,234183.1179)};
	\addlegendentry{4 Threads}
	\addplot[
        mark=x,
        color=violet] coordinates {
            (9, 206894.3049)
			(16, 412005.2777)
			(25, 616785.9578)
			(36, 963066.0121)
			(49, 1490017.073)
			(64, 2024705.029)
			(100, 2846381.623)
			(144, 4270917.234)
			(196, 4889061.938)
			(225, 5368039.349)
			(400, 6165113.665)
			(441, 6040768.307)
			(576, 5817354.332)
			(784, 4252592.221)
			(900, 3493402.238)
			(1225, 1724497.681)
			(1600, 855346.1252)};
	\addlegendentry{16 Threads}
	\addplot[
        mark=triangle,
        color=black] coordinates {
            (9,281779.808)
			(16,517637.3306)
			(25,973493.8339)
			(36,1447752.336)
			(49,2218977.423)
			(64,3015183.042)
			(100,4835169.757)
			(144,5961287.097)
			(196,6677700.456)
			(225,6648565.755)
			(400,7185663.879)
			(441,7229902.614)
			(576,7071017.28)
			(784,5748545.115)
			(900,4713074.266)
			(1225,2840853.623)
			(1600,1494606.359)};
	\addlegendentry{28 Threads}
    \end{axis}
\end{tikzpicture}
\caption{Performance of the decomposed MatMult kernel on a fixed problem size (705600 grid points) for various thread counts and total elements.}
\end{figure}
										
													

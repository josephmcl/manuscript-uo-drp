\begin{figure}[!b]
\begin{tikzpicture}
    \begin{axis}[
	    legend style={
            at={(0.5,-0.2)},
            anchor=north,
            legend columns=2},
        height=1.75in,
        width=\columnwidth,
        axis x line*=bottom,
        axis y line*=left,
        symbolic x coords = {9, 16, 25, 36, 49, 64, 100, 144, 196, 225, 400, 441, 576, 784, 900, 1225, 1600},
        xtick = {9, 49, 196, 576, 1600},
        ytick distance=25.,
        domain = 9:1600,
        range = 0:1,
        xlabel={\small Elements ($\ell^2$)},
        ylabel={\small Percent ideal speed up}]
	\addplot[
        mark=+,
        color=red] coordinates { 
            (9,89.80772783)
			(16,81.44809896)
			(25,84.01265431)
			(36,91.65362266)
			(49,97.3178835)
			(64,95.66418795)
			(100,94.91731162)
			(144,90.23017479)
			(196,89.04560603)
			(225,89.42606936)
			(400,88.52873523)
			(441,90.96957938)
			(576,89.89312948)
			(784,96.362808)
			(900,95.4433221)
			(1225,97.19841906)
			(1600,98.58183248)};
	\addlegendentry{2 Threads}
    \addplot[
        mark=o,
        color=blue] coordinates {
            (9,81.24280595)
			(16,72.35409511)
			(25,71.87422205)
			(36,73.97099956)
			(49,87.57828937)
			(64,88.09522093)
			(100,86.80642458)
			(144,84.38193744)
			(196,80.28113664)
			(225,79.68067235)
			(400,73.36438178)
			(441,74.36115039)
			(576,74.44781356)
			(784,84.37458405)
			(900,84.94134329)
			(1225,89.72037773)
			(1600,91.68107848)};
	\addlegendentry{4 Threads}
	\addplot[
        mark=square,
        color=green] coordinates {
            (9,70)
			(16,63)
			(25,58)
			(36,62)
			(49,69)
			(64,70)
			(100,67)
			(144,64)
			(196,61)
			(225,60)
			(400,58)
			(441,58)
			(576,58)
			(784,74)
			(900,75)
			(1225,84)
			(1600,89)};
	\addlegendentry{8 Threads}
	\addplot[
        mark=x,
        color=violet] coordinates {
            (9,53.52149343)
			(16,55.72203392)
			(25,50.88135743)
			(36,52.24498021)
			(49,59.47561476)
			(64,62.16044819)
			(100,56.57392172)
			(144,60.4699287)
			(196,52.77826458)
			(225,52.08890179)
			(400,45.50386094)
			(441,45.10367777)
			(576,52.38086479)
			(784,64.13954692)
			(900,71.95346234)
			(1225,79.35939415)
			(1600,83.71552989)};
	\addlegendentry{16 Threads}			
	\addplot[
        mark=triangle,
        color=black] coordinates {
            (9,41.65350074)
			(16,40.00476479)
			(25,45.89013843)
			(36,44.87916193)
			(49,50.6130524)
			(64,52.89663054)
			(100,54.91573947)
			(144,48.23033634)
			(196,41.1925286)
			(225,36.86544072)
			(400,30.30651572)
			(441,30.84708825)
			(576,36.38237089)
			(784,49.5441113)
			(900,55.47142684)
			(1225,74.70446109)
			(1600,83.58972861)};
	\addlegendentry{28 Threads}
    \end{axis}
\end{tikzpicture}
\caption{Performance of the decomposed MatMult kernel on a fixed problem size (705600 grid points) for various thread counts and total elements.}
\end{figure}
										
													
